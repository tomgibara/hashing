Hashing
=======

Overview
--------

This library provides an API for defining hash functions and computing their
values. It aims for generality while providing for efficient implementation.
The core abstractions are:

 * `HashCode` - the result of computing a hash.
 * `HashSerializer` - decomposes objects into a stream for them to be
    hashed.
 * `Hash` - converts the contents of a stream into a `HashCode`
 * `Hasher` can convert an object into a `HashValue`,
    often by way of a `Hash` combined with a `WriteStream`
 * `Hashing` - the entry-point to the API and the basis for obtaining
    provided `Hash` and `Hasher` implementations.
 * `HashSize` - defines the range of `HashCode` values generated by a
   `Hashing` implementation.
 * `HashDigests` - a source `MessageDigest` instances that is adaptable into
    a `Hash`

Note that decomposition of objects into byte streams depends on abstractions
provided by the [`streams` project][0].

Examples
--------

```java
// returns the object hashCode
Hasher<String> obj = Hashing.objectHasher();
obj.intHashValue(str); // returns str.hashCode()

// returns System.identityHashCode
Hasher<String> ident = Hashing.identityHasher();
ident.intHashValue(str); // returns System.identityHashCode(str)

// creates a 32 bit murmur hash code...
Hasher<String> murmur = Hashing.murmur3Int()
		.hasher((s, out) -> out.writeChars(s));

// ...different object types are easily supported ...
Hasher<Point> murmurPt = Hashing.murmur3Int()
		.hasher((p, s) -> { s.writeInt(p.x); s.writeInt(p.y); });

// .. different sized hashes are easily derived.
Hasher<String> shortMurmur = murmur.sized(HashSize.SHORT_SIZE);
shortMurmur.intHashValue(str); // guaranteed to be in the range 0-65535

// derive seeded hashers to protect against collision attacks
Hasher<String> murmurSafe = Hashing.murmur3Int()
		.seeded((s, out) -> out.writeChars(s), randomSeed);
{
	murmurSafe.hash(str);
	// almost certainly not the same as murmur.hashValue(str)
}

// derive multiple hash values from a single hash function
Hasher<String> multiple = murmur.ints();
{
	HashCode value = multiple.hash(str);
	value.intValue(); // first hash value
	value.intValue(); // next hash value
	value.intValue(); // .. and so on ..
}

// derive multiple *distinct* hash values from a single hash function
Hasher<Point> distinct = murmurPt.distinct(3, HashSize.BYTE_SIZE);
{
	HashCode value = distinct.hash(pt);
	value.intValue(); // first hash value
	value.intValue(); // second hash value
	value.intValue(); // third hash value
	value.hasNext();  // returns false - supplies exactly 3 hashes
	                  // all guaranteed to be distinct
}

// produce hashes from message digests
Hash sha1 = Hashing.SHA_1().asHash();

// produce hashes by seeding a random number generator
Hash prng = Hashing.prng(HashSize.LONG_SIZE);

// use this capability to produce cryptographically secure hashes ...
Hash secure = Hashing.prng("SHA1PRNG", HashSize.fromByteLength(16));

// ... with arbitrarily large hash codes
secure.hasher(someStream).bytesHashValue(str); // 128 bit hash code

// derive hashes from integer valued functions
Hasher<Point> simple = Hashing.intDerivedHasher(pt -> pt.x + pt.y);
```

Comparison with Guava
---------------------

A high quality hashing library is already available for Java as part of the
Guava library [*][1] but this library has some capabilities that Guava does not
currently have. Any of these may be necessary for your application:

 * Direct emulation of `Object.hashCode()` and `System.identityHashCode()`
   (so existing Java hash codes can be exposed through the API).
 * Support for multi-valued hashes
   (useful for probabalistic data structures such as Bloom filters).
 * Hashes that do not necessarily span an exact number of bits.

Documentation
-------------

Comprehensive javadocs accompany the release; they may be browsed online at
[javadoc.io][2].

Usage
-----

The hashing library is available from the Maven central repository:

> Group ID:    `com.tomgibara.hashing`
> Artifact ID: `hashing`
> Version:     `2.1.0`

The Maven dependency being:

    <dependency>
      <groupId>com.tomgibara.hashing</groupId>
      <artifactId>hashing</artifactId>
      <version>2.1.0</version>
    </dependency>

Release History
---------------

**2016.10.22** Version 2.1.0

 * Fixes bug where the Murmur3 hash was returning 8 bytes and not 4.
 * Fixes Java and identity hashes to return positive long representations
 * Adds `Hashing.intDerivedHasher()` to derive hashes from int valued functions
 * Fixes `HashCode.fromBigs()` to properly honour supplied hash size.

**2015.12.10** Version 2.0.0

 * Updates to use latest version of `stream` library
 * Replaces `HashSerializer` with `StreamSerializer`
 * Removes generics from the `Hash` class
 * Removes perfect hashing (for inclusion in a future library) 
 * Fixes bugs in resizing of multi-valued hash codes
 * Provides convenient access to MD5 and SHA-256 digest hashes
 * Now constructs hash digests via the `Hashing` class 
 * Various method name standardizatons and improvements
 * Renames `HashDigestSource` to `HashDigests`

**2015.07.27** Version 1.0.0

Initial release

[0]: https://github.com/tomgibara/streams
[1]: https://github.com/google/guava
[2]: http://www.javadoc.io/doc/com.tomgibara.hashing/hashing